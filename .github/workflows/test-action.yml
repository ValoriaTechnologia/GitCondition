name: Test action (integration)

on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]
  workflow_dispatch:

jobs:
  run-action:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # Runs the action via Docker: GitHub builds the Dockerfile and runs the container (no bypass).
      - name: Check path changes
        id: check_path
        uses: ./
        with:
          path: main.py

      - name: Detected change under path
        if: steps.check_path.outputs.changed == 'true'
        run: echo "Action reported changed=true for the given path."

      - name: No change under path
        if: steps.check_path.outputs.changed == 'false'
        run: echo "Action reported changed=false for the given path."

      - name: Show output
        run: echo "changed=${{ steps.check_path.outputs.changed }}"
